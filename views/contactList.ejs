<div class="contact-list-container">  
    <div class="contact-list-header">  
        <h1>문의 목록</h1>  
        <p>접수된 문의사항 목록입니다</p>  
    </div>  

    <div class="contact-table-wrapper">  
        <% if (lists && lists.length > 0) { %>  
            <table class="contact-table">  
                <thead>  
                    <tr>  
                        <th>번호</th>  
                        <th>이름</th>  
                        <th>연락처</th>  
                        <th>이메일</th>  
                        <th>문의내용</th>  
                        <th>상태</th>  
                        <th>등록일</th>  
                        <th>수정일</th>  
                        <th>처리</th>  
                        <th>삭제</th>  
                    </tr>  
                </thead>  
                <tbody>  
                    <% lists.forEach(function(item) { %>  
                    <tr>  
                        <td><%=item.id%></td>  
                        <td><%=item.name%></td>  
                        <td><%=item.phone%></td>  
                        <td><%=item.email%></td>  
                        <td class="memo-cell"><%=item.memo%></td>  
                        <td>  
                            <% if(item.status === 'done') { %>  
                                <span class="status-badge completed">처리완료</span>  
                            <% } else { %>  
                                <span class="status-badge pending">대기중</span>  
                            <% } %>  
                        </td>  
                        <td><%=new Date(item.create_at).toLocaleDateString()%></td>  
                        <td><%=new Date(item.modify_at).toLocaleDateString()%></td>  
                        <td>  
                            <% if(item.status !== 'done') { %>  
                                <button class="update-btn" type="button" onclick="updateContact(<%=item.id%>)">  
                                    처리하기  
                                </button>  
                            <% } else { %>  
                                <button class="update-btn" disabled>  
                                    처리완료  
                                </button>  
                            <% } %>  
                        </td>  
                        <td>  
                            <button class="delete-btn" type="button" onclick="deleteContact(<%=item.id%>)">  
                                삭제  
                            </button>  
                        </td>  
                    </tr>  
                    <% }) %>  
                </tbody>  
            </table>  
        <% } else { %>  
            <div class="no-data-message">  
                <p>등록된 문의사항이 없습니다.</p>  
            </div>  
        <% } %>  
    </div>  
</div>  

<script>  
    async function updateContact(contactId) {  
        if(confirm('문의사항을 처리완료로 변경하시겠습니까?')) {  
            try {  
                const response = await fetch(`/api/contactUpdate/${contactId}`, {  
                    method: 'PUT',  
                    headers: {  
                        'Content-Type': 'application/json'  
                    }  
                });  

                if (!response.ok) {  
                    throw new Error('업데이트 오류');  
                }  
                alert('문의사항이 처리완료로 변경되었습니다.');  
                location.reload();  
            } catch (error) {  
                console.error('업데이트 오류:', error);  
            }  
        }  
    }  

    function deleteContact(contactId) {  
        if(confirm('정말 이 문의사항을 삭제하시겠습니까?')) {  
            $.ajax({  
                url: `/api/contactDelete/${contactId}`,  
                type: 'DELETE',  
                success: function(response) {  
                    location.reload();  
                },  
                error: function(error) {  
                    console.error("삭제 오류: ", error)  
                }  
            });  
        }  
    }  
</script>  

<style>  
    .contact-list-container {  
        padding: 20px;  
        max-width: 1200px;  
        margin: 0 auto;  
    }  

    .contact-list-header {  
        text-align: center;  
        margin-bottom: 30px;  
    }  

    .contact-list-header h1 {  
        color: #333;  
        margin-bottom: 10px;  
    }  

    .contact-table-wrapper {  
        background: white;  
        border-radius: 8px;  
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);  
        overflow-x: auto;  
    }  

    .contact-table {  
        width: 100%;  
        border-collapse: collapse;  
    }  

    .contact-table th,  
    .contact-table td {  
        padding: 12px 15px;  
        text-align: left;  
        border-bottom: 1px solid #eee;  
    }  

    .contact-table th {  
        background-color: #f8f9fa;  
        font-weight: bold;  
    }  

    .memo-cell {  
        max-width: 200px;  
        white-space: nowrap;  
        overflow: hidden;  
        text-overflow: ellipsis;  
    }  

    .status-badge {  
        padding: 5px 10px;  
        border-radius: 15px;  
        font-size: 0.85em;  
    }  

    .status-badge.pending {  
        background-color: #fff3cd;  
        color: #856404;  
    }  

    .status-badge.completed {  
        background-color: #d4edda;  
        color: #155724;  
    }  

    .update-btn, .delete-btn {  
        padding: 6px 12px;  
        border: none;  
        border-radius: 4px;  
        cursor: pointer;  
        font-size: 0.9em;  
        transition: background-color 0.2s;  
    }  

    .update-btn {  
        background-color: #28a745;  
        color: white;  
    }  

    .update-btn:hover {  
        background-color: #218838;  
    }  

    .update-btn:disabled {  
        background-color: #cccccc;  
        cursor: not-allowed;  
    }  

    .delete-btn {  
        background-color: #dc3545;  
        color: white;  
    }  

    .delete-btn:hover {  
        background-color: #c82333;  
    }  

    .no-data-message {  
        text-align: center;  
        padding: 40px;  
        color: #666;  
    }  

    @media (max-width: 768px) {  
        .contact-table-wrapper {  
            margin: 0 -20px;  
        }  
        
        .contact-table th,  
        .contact-table td {  
            padding: 8px 10px;  
            font-size: 0.9em;  
        }  

        .memo-cell {  
            max-width: 150px;  
        }  
    }  
</style>